---
title: "Who were the best Premier League Players in their positions"
output: html_document
date: "2025-11-10"
author: " By Theodore Etuwewe & Usman Agboola" 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)
library(readr)
library(scales)
library(stringr)
premleague <- read.csv("premleague.csv")
```

## *Introduction*
The Premier League is a battlefield, and every player is fighting for glory. Because of this, we were inspired to find out who was truly number 1 in their positions. The analysis aims to dive into the stats that separate the stars from the rest; goals, assists, tackles, interceptions, clean sheets, and more. By looking at offensive firepower, defensive strength, and goalkeeping feats, we aim to crown the ultimate player of the season, the one who dominates all players of the game.

We got this dataset from Kaggle, and here's a link to it: [English Premier League Player Stats](https://www.kaggle.com/datasets/rishikeshkanabar/premier-league-player-statistics-updated-daily)

But before we look into the data, lets clean it up a bit. 

# *Cleaning Up process*

```{r}

library(dplyr)
library(stringr)

premleague <- premleague %>%
  mutate(across(everything(), ~ ifelse(is.na(.), 0, .))) %>%  # changes NA values to zero
  filter(!is.na(Name) & Name != "") %>%                       # removes rows with missing player name     
  distinct()                                                  # removes duplicate rows

glimpse(premleague)


```

As you can see, there is a lot to look at here. This dataset contains detailed statistics for Premier League players like their offensive metrics, defensive metrics, and goalkeeper-specific statistics. What makes it interesting is the depth of information for each player, allowing analysis of scoring efficiency, defensive performance, and overall contribution to the team. It enables comparisons between players across positions, highlighting strengths and patterns that are not obvious from simple totals, such as who is the most efficient scorer or the most influential defender.




# *What do we intend to learn from this data?*

# *Core question*
1. Who is the best person to ever touch the Field? 

# *Other questions*
1. Who scored the most goals?

2. Who provided the most assists or created the most big chances?

3. Who had the highest goal involvement (goals + assists)?

4. Which midfielders had the highest passing accuracy and most key passes?

5. Which defenders had the most tackles, interceptions, and clearances?

6. Which goalkeepers had the most clean sheets, saves, and penalties saved?

7. Who had the best overall efficiency?

8. Who had the highest combined offensive and defensive contribution?


*Alright*. enough chitchat. I believe its time to get down and dirty with the details.

# *1.Who scored the most goals?*

```{r}
topgoals <- premleague %>% 
  arrange(-Goals) %>% 
  slice_head(n = 10)

ggplot(topgoals, aes(x = reorder(Name, Goals), y = Goals)) +
  geom_col(fill = "steelblue") + 
  geom_text(aes(label = Goals), vjust = -0.5) +
  coord_flip() +
  labs(
    title = "Top 10 Goal Scorers",
    x = "Player Name" ,
    y = "Goals") +
theme_minimal()
```


# *2. Who provided the most assists or created the most big chances?*

```{r}
topassists <- premleague %>% 
  arrange(-Assists) %>% 
  slice_head(n = 10)

ggplot(topassists, aes(x = reorder(Name, Assists), y = Assists, fill = Assists)) +
  geom_col() +
  labs(
    title = "Top 10 Assist Makers",
    x = "Player" ,
    y = "Assists") +
  scale_fill_gradient(low = "lightgreen", high = "darkgreen") +
  theme_minimal() +
  coord_flip()
```


# *3. Who had the highest goal involvement (goals + assists)?*

```{r}

```

4. Which midfielders had the highest passing accuracy and most key passes?

5. Which defenders had the most tackles, interceptions, and clearances?

6. Which goalkeepers had the most clean sheets, saves, and penalties saved?

# *7. Who had the best overall efficiency?*

First we need to determine how we will get the efficiency of the players. We did this by combining variables such as goals, assists, interceptions, etc. That's how we'll see who shined brighter than their peers.

```{r}
efficiency <- premleague %>%
  mutate(
    efficiency = Goals + Assists + (Tackles + Interceptions + Clearances) / 10)
```


```{r}
top_eff <- premleague %>%
  slice_max(order_by = efficiency, n = 15) # Gives the top 15 efficient players

heatdata <- top_eff %>%
  select(Name, Club, Goals, Assists, Tackles, Interceptions, Clearances) %>%
  pivot_longer(
    cols = c(Goals, Assists, Tackles, Interceptions, Clearances),
    names_to = "Stat",
    values_to = "Value"
  )  # Preparing data for the heatmap

# Compute order for players
playerorder <- heatdata %>%
  group_by(Name) %>%
  summarise(avg_value = mean(Value, na.rm = TRUE)) %>%
  arrange(desc(avg_value)) %>%
  pull(Name)

# Heatmap
ggplot(heatdata, aes(x = Stat, y = factor(Name, levels = playerorder), fill = Value)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "white", high = "darkgreen") +
  labs(
    title = "Top 15 Premier League Players by Efficiency Stats",
    x = "Statistic",
    y = "Player Name"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


```

8. Who had the highest combined offensive and defensive contribution?

